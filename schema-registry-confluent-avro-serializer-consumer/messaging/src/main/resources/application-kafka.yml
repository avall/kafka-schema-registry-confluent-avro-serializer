spring:
  cloud:
    stream:
      default-binder: kafka
      function.definition: process;attachment;
      bindings:
        process-in-0:
          destination: sensor-topic
          group: group-sensor-topic
          consumer:
            useNativeDecoding: true
        attachment-in-0:
          destination: attachment-topic
          group: group-attachment-topic
          consumer:
            useNativeDecoding: true

      kafka:
        binder:
          brokers: ${APP_KAFKA_BROKERS:localhost:9094}
          consumer-properties:
            #            key.deserializer: io.confluent.kafka.serializers.KafkaAvroDeserializer
            value.deserializer: io.confluent.kafka.serializers.KafkaAvroDeserializer
            schema.registry.url: ${APP_SCHEMA_REGISTRY_URL:http://localhost:8084}
            specific.avro.reader: true
          producer-properties:
            #            key.serializer: io.confluent.kafka.serializers.KafkaAvroSerializer
            value.serializer: io.confluent.kafka.serializers.KafkaAvroSerializer
            schema.registry.url: ${APP_SCHEMA_REGISTRY_URL:http://localhost:8084}
          # https://docs.confluent.io/platform/current/installation/configuration/producer-configs.html
          # https://kafka.apache.org/documentation/#producerconfigs
#        binder:
#          consumerProperties:
#            value:
#              subject:
#                name:
#                  strategy: io.confluent.kafka.serializers.subject.RecordNameStrategy

        bindings:
          process-in-0:
            consumer:
              topic.properties:
                retention.ms: 604800000
              configuration:
                value.deserializer: io.confluent.kafka.serializers.KafkaAvroDeserializer
                schema.registry.url: ${APP_SCHEMA_REGISTRY_URL:http://localhost:8084}
                specific.avro.reader: true
          attachment-in-0:
            consumer:
              topic.properties:
                  retention.ms: 604800000
              configuration:
                value.deserializer: io.confluent.kafka.serializers.KafkaAvroDeserializer
                schema.registry.url: ${APP_SCHEMA_REGISTRY_URL:http://localhost:8084}
                specific.avro.reader: true


